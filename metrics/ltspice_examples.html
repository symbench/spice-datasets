<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <title>Dataset Metrics: Example Circuits from LTspice</title>
        <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
    </head>
    <body>
        <h1 style="text-align:center">Dataset Metrics: Example Circuits from LTspice</h1>
    </body>
    <script type="text/javascript">
        function createBarChart(data, labels) {
            const layout = {
                title: labels.title,
                xaxis: {title: labels.x},
                yaxis: {title: labels.y},
            };
            const div = document.createElement('div');
            const id = labels.title + Date.now();
            div.setAttribute('id', id);
            document.body.appendChild(div);
            Plotly.newPlot(id, data, layout);
        }

        function createDatasetVisualizations(dataset) {
            delete dataset.componentCounts['0'];  // remove empty files
            createBarChart([{
                x: Object.keys(dataset.componentCounts),
                y: Object.values(dataset.componentCounts),
                type: 'bar',
            }], {
                title: 'Component Count Distribution',
                x: '# of Components',
                y: 'Count',
            });

            createBarChart([
                {
                    x: Object.keys(dataset.componentTypeCounts),
                    y: Object.values(dataset.componentTypeCounts),
                    type: 'bar'
                }
            ], {
                title: 'Dataset Component Counts',
                x: 'Component Type',
                y: 'Frequency',
            });


            // TODO: maybe add a switcher?
            Object.keys(dataset.componentTypesByNetlist).sort().forEach(componentType => {
                const counts = dataset.componentTypesByNetlist[componentType];
                createBarChart([
                    {
                        x: Object.keys(counts),
                        y: Object.values(counts),
                        type: 'bar'
                    }
                ], {
                    title: `Usage of ${componentType} per Netlist`,
                    x: `# of ${componentType} Components in Netlist`,
                    y: '# of Netlists',
                });
            });
        }

        createDatasetVisualizations({"componentCounts": {"12": 155, "11": 177, "3": 53, "6": 319, "5": 305, "45": 3, "4": 209, "8": 259, "20": 43, "9": 174, "25": 25, "2": 6, "14": 108, "16": 80, "7": 326, "19": 58, "10": 161, "13": 101, "17": 82, "15": 141, "23": 26, "24": 36, "18": 43, "26": 33, "28": 22, "22": 35, "27": 14, "34": 19, "35": 12, "36": 10, "38": 10, "37": 18, "33": 16, "32": 15, "30": 17, "21": 48, "39": 2, "31": 21, "64": 3, "51": 5, "29": 14, "40": 6, "41": 7, "62": 4, "58": 3, "44": 5, "43": 2, "46": 3, "47": 1, "77": 1, "68": 2, "48": 3, "55": 1, "53": 2, "42": 2, "49": 1, "74": 1, "106": 1, "65": 1, "52": 1, "82": 1, "56": 1, "50": 1, "108": 1, "97": 1, "1": 1}, "componentTypeCounts": {"V": 5859, "R": 14141, "D": 1943, "X": 3605, "C": 9853, "M": 1632, "Q": 310, "B": 36, "J": 20, "L": 2293, "E": 57, "K": 199, "I": 138, "T": 20, "S": 127, "A": 68, "G": 37, "Z": 1}, "componentTypesByNetlist": {"V": {"3": 580, "4": 140, "1": 1928, "2": 490, "5": 37, "6": 22, "7": 32, "8": 6, "9": 1, "15": 1, "13": 2, "12": 1}, "R": {"5": 239, "1": 608, "3": 459, "2": 429, "23": 3, "6": 244, "11": 65, "4": 416, "8": 115, "10": 84, "7": 143, "9": 87, "12": 41, "19": 6, "20": 4, "13": 20, "14": 36, "16": 9, "15": 15, "17": 8, "18": 6, "25": 3, "21": 3, "36": 1, "26": 2, "31": 1, "28": 3, "24": 2, "35": 2, "30": 1, "44": 1, "29": 1, "22": 1}, "D": {"2": 296, "6": 18, "1": 495, "10": 7, "4": 72, "3": 56, "5": 13, "9": 6, "11": 2, "7": 5, "17": 2, "12": 1}, "X": {"2": 198, "1": 2920, "4": 34, "3": 34, "6": 4, "5": 4, "7": 1}, "C": {"1": 768, "8": 72, "3": 367, "6": 139, "2": 485, "4": 373, "5": 189, "7": 84, "9": 43, "10": 37, "14": 15, "12": 26, "15": 8, "11": 39, "16": 5, "17": 5, "19": 3, "13": 18, "18": 2, "26": 1, "39": 1, "21": 1, "23": 1, "20": 1, "24": 1, "41": 1, "65": 1}, "M": {"2": 226, "1": 203, "4": 140, "3": 39, "6": 24, "12": 2, "8": 6, "5": 12, "7": 2, "10": 1}, "Q": {"8": 7, "1": 59, "2": 21, "4": 1, "3": 3, "19": 1, "5": 1, "29": 1, "20": 1, "18": 1, "10": 1, "32": 1, "7": 1}, "B": {"2": 2, "1": 25, "3": 1, "4": 1}, "J": {"1": 11, "9": 1}, "L": {"1": 969, "3": 55, "2": 302, "7": 3, "5": 21, "4": 36, "6": 8, "8": 14, "12": 2, "10": 1, "20": 1, "9": 1, "11": 2, "25": 1, "15": 1}, "E": {"2": 15, "3": 7, "1": 6}, "K": {"1": 136, "2": 16, "3": 5, "6": 2, "4": 1}, "I": {"1": 111, "5": 1, "2": 6, "3": 2, "4": 1}, "T": {"1": 10, "2": 5}, "S": {"1": 62, "2": 25, "6": 1, "3": 3}, "A": {"41": 1, "3": 2, "1": 9, "2": 2, "4": 2}, "G": {"1": 10, "2": 5, "4": 3, "5": 1}, "Z": {"1": 1}}});
    </script>
</html>

